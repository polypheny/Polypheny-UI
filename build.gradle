
group 'org.polypheny'
description = "The user interface for Polypheny-DB"

def versionMajor = 1
def versionMinor = 0
def versionQualifier = "-SNAPSHOT"
version = versionMajor + "." + versionMinor + versionQualifier


buildscript {
    repositories {
        mavenCentral()
        jcenter()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
		classpath "com.github.node-gradle:gradle-node-plugin:3.0.1"
    }
}


repositories {

}


apply plugin: 'java'
apply plugin: 'maven-publish'
apply plugin: 'com.github.node-gradle.node'



dependencies {

}


node {
  version = '16.2.0'
  //npmVersion = '16.1.0'
  download = true
}


npmInstall.args = ['--package-lock', '--loglevel', 'warn']

npm_run_build.dependsOn(npmInstall)

jar.dependsOn(npm_run_build)

jar {
  from 'dist' into 'webapp'
  manifest {
        attributes "Manifest-Version": "1.0"
        attributes "Copyright": "The Polypheny Project"
        attributes "Version": "$archiveVersion"
    }
}


publishing {
    publications {
        "${project.name}"(MavenPublication) {
            from components.java
            pom {
                licenses {
                    license {
                        name = 'Apache License, Version 2.0'
                        url = 'http://www.apache.org/licenses/LICENSE-2.0'
                    }
                }
            }
        }
    }
}
task generatePom(group: 'publishing', dependsOn: "generatePomFileFor${project.name.capitalize()}Publication")


//clean.dependsOn(npm_cache_clean)

clean {
    delete "/dist"
	delete "/build"
	delete "/node_modules"
}

// Add install task
task install(group: 'other', dependsOn: publishToMavenLocal)
