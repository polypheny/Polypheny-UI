<c-card class="list-container border bg-light mb-3" *ngIf="val()?.length > 0">
    <ul cListGroup cdkDropList (cdkDropListDropped)="drop($event)" flush="true">
        @for (field of val(); track field.name) {
            <li cListGroupItem cdkDrag [cdkDragDisabled]="!isEditable()" class="bg-white list-entry" [class.draggable]="isEditable()">
                <c-row gutter=false>
                    <c-col [xs]="10">
                        <div class="d-flex mb-2 align-items-center">
                            <app-autocomplete (changed)="valueChanged()"
                                              [data]="suggestions()"
                                              [(value)]="field.name"
                                              [placeholder]="field.regex ? 'regex' : fieldType()"
                                              [disabled]="!isEditable()"
                                              (mousedown)="$event.stopPropagation()">
                            </app-autocomplete>
                            <c-form-check [switch]="true" *ngIf="def().allowRegex" class="ms-2">
                                <input cFormCheckInput type="checkbox" [disabled]="!isEditable()" (change)="valueChanged()"
                                       [(ngModel)]="field.regex" (mousedown)="$event.stopPropagation()"/>
                                <label cFormCheckLabel>Use Regex</label>
                            </c-form-check>
                        </div>
                        <c-input-group sizing="sm">
                            <label cInputGroupText for="selectDir">Direction</label>
                            <select cSelect id="selectDir" [(ngModel)]="field.direction" (change)="valueChanged()"
                                    [disabled]="!isEditable()" (mousedown)="$event.stopPropagation()">
                                <option *ngFor="let choice of dirChoices" [value]="choice">{{ choice }}</option>
                            </select>
                        </c-input-group>
                    </c-col>
                    <c-col [xs]="2" class="text-end p-0" *ngIf="isEditable()">
                        <app-delete-confirm (delete)="deleteField($index)" (mousedown)="$event.stopPropagation()"></app-delete-confirm>
                    </c-col>
                </c-row>
            </li>
        }
    </ul>

</c-card>

<button cButton color="light" *ngIf="isEditable()" (click)="addField()" size="sm">
    Add {{ fieldType() }}
</button>