@if (isRegistryLoaded() && showEditor && session) {
    <div class="h-100">
        @if (nestedSessionStack().length === 0) {
            @switch (session?.type) {
                @case ('USER_SESSION') {
                    <app-workflow-viewer [sessionId]="sessionId" [isEditable]="true" [name]="session.workflowDef.name + ' v' + session.version"
                                         [workflowDef]="session.workflowDef"
                                         (saveWorkflowEvent)="saveSession($event)" (close)="backToDashboard()" (terminate)="terminateSession()"
                                         (openNested)="openNestedSession($event)" (reloadViewer)="reloadViewer()"
                                         (rename)="renameWorkflow($event)">
                    </app-workflow-viewer>
                }
                @case ('API_SESSION') {
                    <app-workflow-viewer [sessionId]="sessionId" [isEditable]="false" [name]="sessionId"
                                         (close)="backToDashboard()" (terminate)="terminateSession()" (openNested)="openNestedSession($event)">
                    </app-workflow-viewer>
                }
                @case ('JOB_SESSION') {
                    <app-workflow-viewer [sessionId]="sessionId" [isEditable]="false" [name]="sessionId" [canTerminate]="false"
                                         (close)="backToJob()" (openNested)="openNestedSession($event)">
                    </app-workflow-viewer>
                }
                @default {
                    <c-callout color="danger">
                        Unsupported Session Type
                    </c-callout>
                }
            }
        } @else if (!hideNested) {
            <app-workflow-viewer [sessionId]="nestedSession().sessionId" [isEditable]="false" [canTerminate]="false"
                                 [name]="'[nested] ' + nestedSession().workflowDef.name"
                                 (close)="closeNestedSession()" (openNested)="openNestedSession($event)">
            </app-workflow-viewer>
        }
    </div>
}
